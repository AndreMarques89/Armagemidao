<app-main
  [icon]="'users'"
  [title]="'Usuarios'"
  [subtitle]="'Cadastro do usuario no sistema bb-watch'"
>
  <form
    class="form mx-2" 
    (ngSubmit)="newUserForm.form.valid && save()"
    #newUserForm="ngForm"
  >
    <div class="row">
      <div class="col-12 col-md-6">
        <div class="form-group">
          <label>Nome:</label>
          <input
            type="text"
            class="form-control"
            name="name"
            [(ngModel)]="user.nome"
            placeholder="Digite o nome"
            #inpName="ngModel"
            [ngClass]="{ 'is-invalid': newUserForm.submitted && inpName.invalid }"
            required
          />
          <p *ngIf="newUserForm.submitted && inpName.invalid">Nome obrigatório</p>
        </div>
      </div>
      <div class="col-12 col-md-6">
        <div class="form-group">
          <label>E-mail:</label>
          <input
            type="email"
            class="form-control"
            name="email"
            [(ngModel)]="user.email"
            placeholder="Digite o e-mail"
            email
            required
            pattern="^[\w.%+-]+@[\w-]+(\.[a-zA-Z0-9]+)+$"
            #inpEmail="ngModel"
            [ngClass]="{ 'is-invalid': newUserForm.submitted && inpEmail.invalid }"
          />
          <div>
            <span *ngIf="newUserForm.submitted && inpEmail.invalid">E-mail inválido. </span>
            <span *ngIf="newUserForm.submitted && !!user.email && user.email.length == 0">E-mail obrigatório. </span>
          </div>
        </div>
      </div>
    </div>

    <hr />
    <div class="row">
      <div class="col-12 d-flex justify-content-end">
        <input type="submit" class="btn btn-primary" value="Salvar" />
        <input type="button" class="btn btn-secondary ml-2" (click)="clear()" value="Cancelar"/>
      </div>
    </div>
  </form>

  <table class="table mt-4">
    <thead>
      <tr>
        <th>Nome:</th>
        <th>E-mail</th>
        <th>Ações</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let user of users">
        <td>{{ user.nome }}</td>
        <td>{{ user.email }}</td>
        <td>
          <button class="btn btn-warning" (click)="load(user)">
            <i class="fas fa-pen"></i>
          </button>

          <button class="btn btn-danger ml-2" (click)="remove(user)">
            <i class="fa fa-trash"></i>
          </button>
        </td>
      </tr>
    </tbody>
  </table>
</app-main>
